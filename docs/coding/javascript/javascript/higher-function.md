---
outline: deep
---

# 高阶函数

## 一、高阶函数是什么

高阶函数（Higher-Order Function, HOF）是指接收函数作为参数，或者返回一个函数作为结果的函数。换句话说，高阶函数不只是“对数据进行运算”，而是将函数本身视作可以被加工和操作的对象。这一特点赋予了 JavaScript 函数更高的 `灵活性` 和 `抽象` 能力，让它不仅仅是代码逻辑的载体，还成为了行为的组合工具。

因此，高阶函数不仅仅是某种技术技巧，而是一种 “面向行为的编程模式”。它在 JavaScript 中的应用场景非常广泛，包括回调、闭包、柯里化、函数式编程等核心概念。这些概念的灵活性和动态行为得益于高阶函数的基础。

高阶函数的重要性源于其 `抽象` 能力 和 行为控制特性。用高阶函数封装原始函数的能力，带来以下几个核心优势：

1. 动态控制和增强行为：高阶函数可以动态调整原始函数的执行行为，从而改变函数的调用方式或执行条件。这使得代码更加灵活、可控，尤其是在某些需要特定调用逻辑的场景（如节流、防抖）中，可以提高代码的性能和适应性。
2. 减少重复代码，提升复用性：通过封装公共逻辑，高阶函数允许我们在不修改原始函数的前提下为其增添功能。例如，日志打印、性能监控等功能可以通过 `装饰器模式` 以高阶函数的形式添加，使代码的复用性大大增强。
3. 抽象复杂逻辑，简化代码结构：高阶函数可以隐藏复杂的内部逻辑，使代码结构更加简洁。比如，柯里化将函数调用分解为逐步的参数传递，使逻辑分层化，从而减少函数的复杂度和调用的认知负担。
4. 支持函数式编程风格：函数式编程以高阶函数为基础，可以用它来组合操作链、处理数据流。高阶函数使得 JavaScript 支持更为流畅的链式调用，增强代码的表现力和可读性，极大简化了数据处理和链式调用的代码量。

## 二、高阶函数原理

高阶函数的核心机制在于将原始函数嵌套在新的函数层中，并灵活控制函数的调用、参数传递以及逻辑增强。我们可以将其作用归结为以下三个方面：

1. 逻辑扩展与包装：通过在原函数外层添加额外逻辑实现，比如日志打印、性能监控等（这类增强逻辑在 JavaScript 中被称为装饰器模式）。
2. 控制参数传递方式：高阶函数可以改变函数接收参数的方式，如柯里化使得参数逐步传递，从而提升了参数应用的灵活性。
3. 控制调用行为：通过封装原函数的调用逻辑，高阶函数可以延迟、限定或改变原始函数的调用方式，实现更细粒度的调用控制。防抖、节流函数即通过此机制来降低资源消耗。

```javascript
var a = 1;

function fn() {
  console.log(a);
}

/**
 * 将函数作为一个参数传递
 */
function foo(fn) {
  var a = 3;
  fn(); // 这里打印 1，fn 在定义时就已经确定了作用域，采用的静态作用域

  function bar() {
    console.log(a);
    console.log(this);
  }

  bar();
}

foo(fn);
```

对于高阶函数的 this 指向并没有违背 this 指向核心原理，函数的 this 指向始终跟其调用有关。并且作用域也还是采用静态作用域。

还有就是闭包的使用，闭包 = 高阶函数 + 函数作用域 + 引擎实现

```javascript
function foo() {
  let num;

  return function bar() {
    num++;
    console.log(num);
  };
}
```

## 三、高阶函数的应用

高阶函数应用很多，以下是常用的使用案例：

1. 闭包
2. 装饰器
3. 函数柯理化
4. 函数式编程
5. 回调函数
6. 数组的 map、filter、reduce 都是高阶函数
